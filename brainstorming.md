# Brainstorming
Completed telemetry tasks

## Firmware

## Telemetry
First task
After running the program, the error message indicated that it crashed at the line: "const jsonData: VehicleData = JSON.parse(msg.toString());" and more specifically at JSON.pase. After reading the spec, I can be certain that this is the problem is question. The immediate suspect is that there were something wrong with the message. Inspecting the message printed on console and the codes confirmed my suspicion as the last 2 message before the crash has the exact same value. To fix this, the first attempt involved using if statement to isolate some potential cases like null, empty message or just generally wrong Json format, but none of them ended up having any affects. The second attempt is to use try catch to circumvent the problem. This indeed did the trick and the program is able to continue running even after receiving the invalid Json message. The issue now is that the frontend still crashed every time the error occurred. Upon further inspection of the code, the third attempt was made that incorporates the codes that communicate with the frontend to the try catch as well so that the frontend only receive message if the the Json is valid.

Second task

For this task, my immediate thought is to add a counter, increment the counter every time the temperature went outside the safe operating temperature range, then reset the counter every 5 seconds or when the error is triggered. This approaches seems to work fine after some experimentations with the server.ts file. To print the error message to the backend terminal is trivial, I just added a few lines on the server file that checks if the counter is above 3. Now the only problem left is to print the error message to the frontend, to do that, I need to find a way for the server to convey the information that the error has occurred to the frontend. The message sent by the backend to the frontend is in the VehicleData format which includes a battery temperature and a timestamp. Since I need the timestamp for error message, that only leaves battery temperature for modification I settled on using battery temperature = -1°C to convey that the error occurred, since it appears that negative temperature doesn't appear under normal circumstances. which does have the downside that when the error does happens, the temperature appeared on the screen will be -1°C instead of the temperature backend received. There's definitely better ways to achieve the same effect, but it did the trick for the time being.

Third task
The first  part of the third task is pretty straightforward, after looking at the code a bit, it's fairly obvious that the live_value.tsx file controls the temperature value appeared on the frontend and I just added a few if statement for different cases of temperature value to change its color.

For the second part of the third task, to make the frontend look a bit better, I decided to add a visual indicator for the temperature and an error indicator for the error mentioned in the second task. For the visual indicator, I am definitely not going to build one from scratch, so I followed the most logical approach, that is, find a package that has one built for me already. After some searching, I settled on using react-gauge-chart, but for some reason I couldn't get it to work no matter what I tried, it keeps saying module not found and some error with types even after installing @types/react-gauge-chart. I did some testing by creating a new react project with Javascript, and it runs without any problem but I failed to make it work when a new project is created with typescript. Since I have no experience with Typescript and the searches did not turn up any results I have to give up on using the package.  Fortunately after a bit more searching I found [react-gauge-component by antoniolago](https://github.com/antoniolago/react-gauge-component) which seems to be a fork of the react-gauge-chart and written in Typescript. Luckily this time it worked. For this temperature gauge component, I added a temperature_gauge.tsx file which has the same structure as the existing live_value.tsx file. As for the error indicator, I simply modified the sentence appeared on the frontend "Live Battery Temperature" by appending the word "safe" or "unsafe" depending if the error is encountered, which is togged on and off using state. Likewise, a value_title.tsx file was added. At the moment the style code is a bit scuffed and is not written with responsive design in mind. Another thing to note is that it's perhaps due to something I added, the server sometimes takes a long time to establish connection with the frontend.

## Cloud

## Cloud
